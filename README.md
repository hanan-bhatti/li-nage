# Li'nage

**Li'nage** is an advanced, line-level version control system (VCS) designed to provide unprecedented insights into code evolution. Unlike traditional VCSs that track files as atomic units, Li'nage tracks the history of individual lines, enabling granular blame capabilities, intelligent change detection, and AI-assisted commit tracking.

## Key Features

*   **Line-Level Tracking**: Maintains a complete history of individual line modifications across all commits, offering deeper insight than file-based tracking.
*   **Pluggable Diff Algorithms**: Select the best strategy for your needs:
    *   **Myers**: General-purpose O(ND) algorithm.
    *   **Patient**: Optimized for long files with unique lines.
    *   **Minimal**: Fast approximation (O(N log N)).
*   **AI-Assisted Commit Tracking**: Detects and tracks code contributions generated by AI tools, providing transparency in modern development workflows.
*   **Multi-Protocol Authentication**: Securely connect to remote repositories using:
    *   **HTTP/HTTPS**: Personal Access Tokens.
    *   **SSH**: Key-based authentication.
    *   **OAuth**: Secure authorization flow.
*   **Visual Commit Graph**: Interactive DAG (Directed Acyclic Graph) visualization of your commit history and branches.
*   **Snapshot-Based Recovery**: Rollback to any previous state with confidence, backed by cryptographic integrity checks.

## Architecture

Li'nage follows a **Four-Layer Clean Architecture** to ensure maintainability and separation of concerns:

1.  **Presentation Layer (UI)**: Windows Forms based interface (`MainWindow`, `EditorView`, `GitGraphView`).
2.  **Controller Layer**: Orchestrates logic between UI and core services (`VersionController`, `AuthController`).
3.  **Business Logic Layer (Core)**: Pure domain logic including `VersionGraphService` and `LineTracker`.
4.  **Infrastructure Layer**: File system monitoring, `CredentialStore` (Windows Credential Manager), and Transport implementations.

### Technology Stack

*   **Language**: C# 11.0+
*   **Framework**: .NET Framework 4.8 / .NET 7.0+ (Migration in progress)
*   **UI**: Windows Forms
*   **Data Storage**: SQLite (Metadata), NTFS (File System)
*   **Encryption**: AES-256 for credential storage
*   **Hashing**: SHA-256 for content integrity

## Getting Started

### Prerequisites

*   **Operating System**: Windows 10 or 11 (x64)
*   **.NET SDK**: .NET 8.0 SDK (recommended for building) or .NET Framework 4.8 Runtime.
*   **IDE**: Visual Studio 2022 or JetBrains Rider.

### Building the Project

1.  Clone the repository:
    ```bash
    git clone https://github.com/hanan-bhatti/linage.git
    cd linage
    ```

2.  Build the solution:
    ```bash
    dotnet build Linage.sln
    ```

3.  Run the application:
    ```bash
    dotnet run --project Linage.csproj
    ```

## Usage

### 1. Repository Management
*   **Initialize**: Create a new repository in a local folder.
*   **Remote Setup**: Configure remote repositories (GitHub, GitLab, etc.) via the Settings menu.

### 2. Making Commits
*   Edit files in the built-in **Editor View**.
*   The system automatically tracks line changes.
*   Stage your changes and enter a commit message.
*   Click **Commit** to save the snapshot.

### 3. Branching & Merging
*   Create branches to isolate features.
*   Use the **Graph View** to visualize divergent histories.
*   Merge branches with conflict detection (resolution UI coming soon).

### 4. Synchronization
*   **Push** your local commits to a remote server.
*   **Pull** changes from colleagues.
*   Authentication is handled securely via the `CredentialStore`.

## Development

### Project Structure

```
E:\li'nage\
├── Controllers/       # Application logic orchestration
├── Core/             # Domain entities and services (Business Logic)
│   ├── Authentication/ # Credential models and interfaces
│   ├── Diff/           # Diff algorithms (Myers, Patient, etc.)
│   └── ...
├── GUI/              # Windows Forms Views and Designer files
├── Infrastructure/   # External system access (File IO, Network, DB)
├── Tests/            # Unit tests (xUnit)
└── Docs/             # Technical documentation
```

### Running Tests

The project includes a comprehensive test suite using **xUnit** and **Moq**.

To run tests:
```bash
dotnet test Linage.sln
```
*Note: Ensure your environment supports .NET Framework 4.8 SDK-style projects.*

## License

This project is licensed under the **GNU General Public License v3.0**. See the [LICENSE](LICENSE) file for details.

## Contact

*   **Author**: Hanan Bhatti
*   **Copyright**: 2025